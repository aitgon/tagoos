REGION = os.getenv('REGION')
RELEASE = os.getenv('RELEASE')
PREDICT_DIR = os.getenv('PREDICT_DIR')
UCSC_DIR = os.getenv('UCSC_DIR')

rule pu4_01_annotation_hg19:
    input:
        bed=os.path.join(PREDICT_DIR, "prediction_pval_neglog10pval_annotation.bed"),
    output:
        bed=os.path.join(UCSC_DIR, "prediction_neglog10pval_hg19.bed"),
    shell:
        """cat {input.bed} |bedtools expand -c 7 |cut -f1-3,7 > {output.bed}"""

rule pu4_99:
    input:
        os.path.join(UCSC_DIR, "prediction_neglog10pval_hg19.bedgraph"),
        os.path.join(UCSC_DIR, "prediction_neglog10pval_hg38.bedgraph"),

rule pu4_02_neglog10pval_hg38:
    input:
        bed=os.path.join(PREDICT_DIR, "prediction_pval_neglog10pval_annotation_hg38.bed"),
    output:
        bed=os.path.join(UCSC_DIR, "prediction_neglog10pval_hg38.bedgraph"),
    shell:
        """cat {input.bed} |cut -f 1-3,6 > {output.bed}"""

rule pu4_01_neglog10pval_hg19:
    input:
        bed=os.path.join(PREDICT_DIR, "prediction_pval_neglog10pval_annotation.bed"),
    output:
        bedgraph=os.path.join(UCSC_DIR, "prediction_neglog10pval_hg19.bedgraph"),
        bw=os.path.join(UCSC_DIR, "prediction_neglog10pval_hg19.bw"),
    shell:
        """cat {input.bed} |cut -f 1-3,6 > {output.bedgraph};
        bedGraphToBigWig {output.bedgraph} ${CHROM_SIZES_DIR}/${ASSEMBLY}.chrom.sizes {output.bw}"""

