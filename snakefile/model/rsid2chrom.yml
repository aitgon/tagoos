GENOME1K_PEAKBED_DIR = os.getenv('GENOME1K_PEAKBED_DIR')
HOME = os.getenv('HOME')
TAG_DIR = os.getenv('TAG_DIR')
TAG_POS_RSID = os.getenv('TAG_POS_RSID')
THREADS = int(os.getenv('THREADS'))

rule rsdi2chrom:
    input:
        tag_rsid_pos = TAG_POS_RSID,
        peak_bed = os.path.join(HOME, "data/2015_svmgwas/data/variant/1000genomes/eur/eur.peak.bed"),
        script = os.path.join(HOME, "data/2015_svmgwas/data/hcomp/get_record"),
    output:
        chrom_list = os.path.join(TAG_DIR, "../chrom_list.txt")
    threads: THREADS
    shell:
        """find {GENOME1K_PEAKBED_DIR} -name "chr*.bed" |xargs cat |grep -F -w -f {input.tag_rsid_pos} |cut -f1,1 |sort -u --parallel {threads} |tr -d 'chr' > {output.chrom_list}"""

